--- a/fsck_hfs.tproj/cache.h
+++ b/fsck_hfs.tproj/cache.h
@@ -29,6 +29,7 @@
 #ifndef _CACHE_H_
 #define _CACHE_H_
 #include <stdint.h>
+#include <sys/types.h>
 
 /* Different values for initializing cache */
 enum {
--- a/fsck_hfs.tproj/fsck_messages.c
+++ b/fsck_hfs.tproj/fsck_messages.c
@@ -68,6 +68,14 @@ struct context {
 	fsckBlock_t postMessage;
 };
 
+#ifndef __va_copy
+#ifdef va_copy
+#define __va_copy va_copy
+#else
+#define __va_copy(a, b)  memcpy(&(a), &(b), sizeof(va_list))
+#endif
+#endif
+
 /*
  * printv(fsck_ctxt_t, const char *, va_list)
  * Take the format and ap list, and turn them into a string.
--- a/fsck_hfs.tproj/utilities.c
+++ b/fsck_hfs.tproj/utilities.c
@@ -74,6 +74,14 @@
 
 #include "fsck_hfs.h"
 
+#ifndef __va_copy
+#ifdef va_copy
+#define __va_copy va_copy
+#else
+#define __va_copy(a, b)  memcpy(&(a), &(b), sizeof(va_list))
+#endif
+#endif
+
 char *rawname __P((char *name));
 char *unrawname __P((char *name));
 
